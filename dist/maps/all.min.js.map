{"version":3,"sources":["Ajax.class.coffee","Caruso.class.coffee","main.coffee"],"names":[],"mappings":"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","file":"all.min.js","sourcesContent":["class Ajax\n  # static method\n  @load: (url, dest, loading = 'Cargando…') ->\n    xhr = new XMLHttpRequest()\n    if 'string' == typeof obj\n      dest = document.getElementById dest\n    xhr.onreadystatechange = ->\n      dest.innerHTML = xhr.responseText\n    xhr.open 'GET', url, true\n    xhr.send ''\n    false\n\n  @jsonPost: (url, parameters, callback = null) ->\n    xhr = new XMLHttpRequest()\n    xhr.open 'POST', url, true\n    xhr.responseType = 'json'\n    xhr.setRequestHeader 'Content-type', 'application/x-www-form-urlencoded'\n    xhr.setRequestHeader 'Content-length', parameters.length\n    xhr.setRequestHeader 'Connection', 'close'\n    if callback\n      xhr.onreadystatechange = ->\n        if xhr.readyState == 4 && xhr.status == 200\n          callback xhr\n    xhr.send parameters\n    xhr\n\n  @getCb: (url, cb) ->\n    xhr = new XMLHttpRequest()\n    xhr.onreadystatechange = ->\n      cb(xhr) if xhr.readyState == 4\n    xhr.open 'GET', url, true\n    xhr.send ''\n    xhr\n\nroot = exports ? this\nroot.Ajax = Ajax\n# vim:set ts=2 sw=2 et:\n","class Caruso\n  movement: 'auto'\n  flagAjaxFree: true\n\n  constructor: (@elem) ->\n    elem = @elem\n    if @movement == 'auto'\n      @movement = elem.querySelectorAll('.item')[0].offsetWidth\n\n    left = elem.querySelectorAll '.left'\n    right = elem.querySelectorAll '.right'\n    scrollable = elem.querySelectorAll '.viewport'\n    container = elem.querySelectorAll '.horizontal'\n    thiss = this\n\n    window.onresize = @fixLengths\n\n    if scrollable.length\n      scrollable[0].addEventListener 'scroll', (e) ->\n        scroll = scrollable[0].scrollLeft\n\n        if scrollable[0].scrollLeft + scrollable[0].offsetWidth >= container[0].offsetWidth - 100\n          thiss.moreItems()\n\n        if scroll <= 0\n          scroll = 0\n          Caruso.hide left[0]\n        else\n          Caruso.show left[0]\n\n        if (scrollable[0].scrollLeft + scrollable[0].offsetWidth) >= container[0].offsetWidth\n          Caruso.hide right[0]\n        else\n          Caruso.show right[0]\n\n      #scrollable[0].dispatchEvent new Event('scroll')\n\n      if left.length\n        # supongo que es uno solito\n        left[0].addEventListener 'click', (e) ->\n          e.preventDefault()\n          e.stopPropagation()\n          if left[0].disabled\n            return false\n\n          scroll = scrollable[0].scrollLeft - thiss.movement\n          scrollable[0].scrollLeft = scroll\n          Caruso.show right[0]\n      if right.length\n        # supongo que es uno solito\n        right[0].addEventListener 'click', (e) ->\n          e.preventDefault()\n          e.stopPropagation()\n          if right[0].disabled\n            return false\n\n          scroll = scrollable[0].scrollLeft + thiss.movement\n          scrollable[0].scrollLeft = scroll\n\n  moreItems: ->\n    elem = @elem\n    right = elem.querySelectorAll '.right'\n    container = elem.querySelectorAll '.horizontal'\n    thiss = this\n    #oldCount = elem.querySelectorAll('.item').length\n\n    if container.length\n      if @flagAjaxFree\n        @flagAjaxFree = false\n        Ajax.getCb '/xhr-html.html?'+Math.random(), (xhr) ->\n          Caruso.loading right[0].children[0]\n          if xhr.response != ''\n            container[0].innerHTML += xhr.response\n            #count = elem.querySelectorAll('.item').length\n            #thiss.fixLengths(count/oldCount)\n            thiss.fixLengths()\n            Caruso.loading right[0].children[0], false\n            Caruso.show right[0]\n            thiss.flagAjaxFree = true\n            true\n          else\n            false\n\n  fixLengths: ->\n    elem = @elem\n    container = elem.querySelectorAll '.horizontal'\n    elems = elem.querySelectorAll '.item'\n    count = elems.length\n    if container.length and count\n      screenW = document.documentElement.clientWidth\n      if screenW >= 768\n        itemsPerPage = 5\n      else if screenW >= 480\n        itemsPerPage = 4\n      else\n        itemsPerPage = 3\n\n      w = 100/count\n      margin = 6/count\n      totalW = 100*count/itemsPerPage\n      console.log count, itemsPerPage, 'totalW: ', totalW\n      container[0].style.width = totalW + \"%\"\n      for item in elems\n        Caruso.show item\n        item.style.width = w + \"%\"\n        #item.style.marignRight = margin + \"%\"\n\n  @show: (elem) ->\n    elem.className = elem.className.replace(/(?:^|\\s)disabled(?!\\S)/g , '')\n    elem.disabled = false\n  @hide: (elem) ->\n    elem.disabled = true\n    elem.className += \" disabled\"\n\n  @loading: (elem, state = true) ->\n    if state\n      elem.innerHTML = '…'\n    else\n      elem.innerHTML = '»'\n\nroot = exports ? this\nroot.Caruso = Caruso\n# vim:set ts=2 sw=2 et:\n","document.addEventListener 'DOMContentLoaded', (event) ->\n  # console.log 'DOM Loaded & Parsed'\n  # asdf =\n  #   'var1': 'valor1'\n  #   'var2':\n  #     'subvar2_1': 'asdf'\n  #     'subvar2_2': 'zxcv'\n\n  # dest = document.getElementById 'dest'\n  # for idx in document.querySelectorAll('#index li a')\n  #   idx.addEventListener \"click\", (e) ->\n  #     Ajax.load @href, dest\n  #     e.preventDefault()\n  # alerx 1\n\n  for gal in document.querySelectorAll('.caruso')\n    caruso = new Caruso(gal)\n  true\n\n  # pelis = Ajax.jsonPost 'http://localhost:8000/'\n  # , 'PageSize=6&Page=1&FieldSet=basic&SearchCondition={\"suscriptionLevel\": 1, \"device\": \"PC\", \"filter\": {\"category\": \"peliculas\", \"genre\": \"terror\"}}'\n  # ,(xhr) ->\n  #   console.log xhr.response\n  #, {'Timestamp': 1425492662, 'Signature': '18cdbf8649fc8e7acde3e91d33db7cd10451cbfe'}\n\n# vim:set ts=2 sw=2 et:\n"],"sourceRoot":"/source/"}