{"version":3,"sources":["Ajax.class.coffee","Caruso.class.coffee","main.coffee"],"names":[],"mappings":"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","file":"all.min.js","sourcesContent":["class Ajax\n  # static method\n  @load: (url, dest, loading = 'Cargando…') ->\n    xhr = new XMLHttpRequest()\n    if 'string' == typeof obj\n      dest = document.getElementById dest\n    xhr.onreadystatechange = ->\n      dest.innerHTML = xhr.responseText\n    xhr.open 'GET', url, true\n    xhr.send ''\n    false\n\n  @jsonPost: (url, parameters, callback = null) ->\n    xhr = new XMLHttpRequest()\n    xhr.open 'POST', url, true\n    xhr.responseType = 'json'\n    xhr.setRequestHeader 'Content-type', 'application/x-www-form-urlencoded'\n    xhr.setRequestHeader 'Content-length', parameters.length\n    xhr.setRequestHeader 'Connection', 'close'\n    if callback\n      xhr.onreadystatechange = ->\n        if xhr.readyState == 4 && xhr.status == 200\n          callback xhr\n    xhr.send parameters\n    xhr\n\n  @getCb: (url, cb) ->\n    xhr = new XMLHttpRequest()\n    xhr.onreadystatechange = ->\n      cb(xhr) if xhr.readyState == 4\n    xhr.open 'GET', url, true\n    xhr.send ''\n    xhr\n\nroot = exports ? this\nroot.Ajax = Ajax\n# vim:set ts=2 sw=2 et:\n","class Caruso\n  movement: 'auto'\n  flagAjaxFree: true\n  moreItemsUrl: '/xhr-html.html?'+Math.random()\n  moreItemsCallback: ->\n    @moreItemsUrl = '/xhr-html.html?'+Math.random()\n\n  constructor: (@elem) ->\n    elem = @elem\n    if @movement == 'auto'\n      @movement = elem.querySelectorAll('.item')[0].offsetWidth\n\n    left = elem.querySelectorAll '.left'\n    right = elem.querySelectorAll '.right'\n    scrollable = elem.querySelectorAll '.viewport'\n    container = elem.querySelectorAll '.horizontal'\n    thiss = this\n    selff = @constructor\n\n    window.onresize = ()->\n      thiss.fixLengths()\n\n    if scrollable.length\n      scrollable[0].addEventListener 'scroll', (e) ->\n        scroll = scrollable[0].scrollLeft\n\n        if scrollable[0].scrollLeft + scrollable[0].offsetWidth >= container[0].offsetWidth - 100\n          thiss.moreItems()\n\n        if scroll <= 0\n          scroll = 0\n          selff.hide left[0]\n        else\n          selff.show left[0]\n\n        if (scrollable[0].scrollLeft + scrollable[0].offsetWidth) >= container[0].offsetWidth\n          selff.hide right[0]\n        else\n          selff.show right[0]\n\n      #scrollable[0].dispatchEvent new Event('scroll')\n\n      if left.length\n        # supongo que es uno solito\n        left[0].addEventListener 'click', (e) ->\n          e.preventDefault()\n          e.stopPropagation()\n          if left[0].disabled\n            return false\n\n          scroll = scrollable[0].scrollLeft - thiss.movement\n          scrollable[0].scrollLeft = scroll\n          thiss.show right[0]\n      if right.length\n        # supongo que es uno solito\n        right[0].addEventListener 'click', (e) ->\n          e.preventDefault()\n          e.stopPropagation()\n          if right[0].disabled\n            return false\n\n          scroll = scrollable[0].scrollLeft + thiss.movement\n          scrollable[0].scrollLeft = scroll\n\n  moreItems: ->\n    # si el moreItemsUrl es vacío entonces no hago mas pedidos\n    return false if @moreItemsUrl == ''\n\n    elem = @elem\n    right = elem.querySelectorAll '.right'\n    container = elem.querySelectorAll '.horizontal'\n    thiss = this\n    selff = @constructor\n    #oldCount = elem.querySelectorAll('.item').length\n\n    if container.length\n      if @flagAjaxFree\n        @flagAjaxFree = false\n        Ajax.getCb @moreItemsUrl, (xhr) ->\n          selff.loading right[0].children[0]\n          if xhr.response != ''\n            container[0].innerHTML += xhr.response\n            #count = elem.querySelectorAll('.item').length\n            #thiss.fixLengths(count/oldCount)\n            thiss.fixLengths()\n            selff.loading right[0].children[0], false\n            selff.show right[0]\n            thiss.moreItemsCallback() if thiss.moreItemsCallback\n            thiss.flagAjaxFree = true\n            true\n          else\n            false\n\n  fixLengths: ->\n    elem = @elem\n    container = elem.querySelectorAll '.horizontal'\n    elems = elem.querySelectorAll '.item'\n    count = elems.length\n    if container.length and count\n      screenW = document.documentElement.clientWidth\n      if screenW >= 768\n        itemsPerPage = 5\n      else if screenW >= 480\n        itemsPerPage = 4\n      else\n        itemsPerPage = 3\n\n      w = 100/count\n      margin = 6/count\n      totalW = 100*count/itemsPerPage\n      container[0].style.width = totalW + \"%\"\n      for item in elems\n        @constructor.show item\n        item.style.width = w + \"%\"\n\n  @show: (elem) ->\n    elem.className = elem.className.replace(/(?:^|\\s)disabled(?!\\S)/g , '')\n    elem.disabled = false\n  @hide: (elem) ->\n    elem.disabled = true\n    elem.className += \" disabled\"\n\n  @loading: (elem, state = true) ->\n    if state\n      elem.innerHTML = '…'\n    else\n      elem.innerHTML = '»'\n\nroot = exports ? this\nroot.Caruso = Caruso\n# vim:set ts=2 sw=2 et:\n","document.addEventListener 'DOMContentLoaded', (event) ->\n  for gal in document.querySelectorAll('.caruso')\n    caruso = new Caruso(gal)\n    caruso.moreItemsUrl = '/xhr-html.html?zzzz='+Math.random()\n    caruso.moreItemsCallback = () ->\n      @moreItemsUrl = '/xhr-html.html?asdf='+Math.random()\n  true\n\n# vim:set ts=2 sw=2 et:\n"],"sourceRoot":"/source/"}